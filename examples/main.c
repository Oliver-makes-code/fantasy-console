#include <tile.h>
#include <std.h>
#include <stdint.h>
#include <gamepad.h>

const uint8_t TILE_0[] = {
    0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const uint8_t TILE_1[] = {
    0x04, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x40, 
    0x44, 0x66, 0x66, 0x55, 0x55, 0x56, 0x66, 0x44, 
    0x46, 0x66, 0x66, 0x66, 0x66, 0x55, 0x66, 0x64, 
    0x45, 0x54, 0x44, 0x55, 0x55, 0x54, 0x45, 0x64, 
    0x46, 0x65, 0x54, 0x44, 0x45, 0x55, 0x45, 0x54, 
    0x46, 0x65, 0x55, 0x55, 0x45, 0x55, 0x44, 0x54, 
    0x45, 0x54, 0x45, 0x55, 0x44, 0x55, 0x54, 0x54, 
    0x46, 0x65, 0x44, 0x55, 0x54, 0x55, 0x54, 0x54, 
    0x46, 0x65, 0x54, 0x45, 0x54, 0x55, 0x54, 0x54, 
    0x46, 0x65, 0x54, 0x45, 0x54, 0x55, 0x54, 0x54, 
    0x46, 0x64, 0x44, 0x55, 0x44, 0x55, 0x54, 0x54, 
    0x45, 0x54, 0x55, 0x55, 0x45, 0x55, 0x44, 0x54, 
    0x46, 0x65, 0x55, 0x55, 0x45, 0x55, 0x45, 0x54, 
    0x46, 0x65, 0x55, 0x44, 0x55, 0x54, 0x45, 0x54, 
    0x44, 0x65, 0x54, 0x45, 0x54, 0x44, 0x55, 0x44, 
    0x04, 0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x40
};

void init() {
    std_Init();

    tile_WritePalette(0, 0x8080FF);
    tile_WritePalette(1, 0x000000);
    tile_WritePalette(2, 0x00FF00);
    tile_WritePalette(3, 0x000000);
    tile_WritePalette(4, 0xFFAB40);
    tile_WritePalette(5, 0xFFDAA5);
    tile_WriteTile(0, TILE_0);
    tile_WriteTile(1, TILE_1);

    tile_SetBackgroundTile(0, 0, 0, 1);

    for (uint8_t i = 1; i < 8; i++)
        tile_Set_BackgroundVisible(i, false);
}

void update() {
    gamepadstate_t state = gamepad_GetState(0);

    tilescroll_t scroll = tile_Get_BackgroundScroll_Pre(0);

    if (state & Gamepad_Left)
        scroll.x++;
    if (state & Gamepad_Right)
        scroll.x--;

    if (state & Gamepad_Up)
        scroll.y++;
    if (state & Gamepad_Down)
        scroll.y--;

    tile_Set_BackgroundScroll_Pre(0, scroll.x, scroll.y);
}

void v_blank(uint8_t y) {
}
